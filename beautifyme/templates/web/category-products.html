{% extends 'base.html' %}
{% load static %}

{% block title %}
    Online shop Beauty Hour
{% endblock %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/category-products.css' %}">
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row mb-3">
            {% for product in products %}
                {% if product.quantity > 0 %}
                    <div class="col-md-3">
                        <div class="card mt-4 mb-4">
                            <div class="card-body">
                                <a href="{% url 'details-product' pk=product.id %}">
                                    <img class="card-img-top rounded" src="{{ product.product_image.url }}"
                                         alt="{{ product.name }}">
                                </a>
                                <div class="d-flex justify-content-between">
                                    <div class="mt-3 overflow-hidden">
                                        <h4 class="fw-bolder card-title mt-3">{{ product.name }}</h4>
                                        <small>{{ product.description }}</small>
                                    </div>
                                    <div class="d-flex overflow-hidden product-price-and-cart-position">
                                        <div>
                                            <h4>{{ product.price }}лв.</h4>
                                        </div>
                                        <div>
                                            {% if not request.user.is_authenticated %}
                                                <a href="{% url 'login' %}"><i
                                                        class="fas cart-position-anonymous-user fa-shopping-cart text-black ml-n4"></i></a>
                                            {% else %}
                                                <form action="{% url 'add-to-cart' product_id=product.id %}">
                                                    {% csrf_token %}
                                                    <input type="hidden" name="product_id" value="{{ product.id }}">
                                                    <button type="submit" class="border-0 bg-transparent">
                                                        <i class="fas fa-shopping-cart text-black"></i>
                                                    </button>
                                                </form>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% empty %}
                {% if request.GET.search %}
                    <h1 class="text-center mt-5">No search results found for "{{ request.GET.search }}"</h1>
                {% else %}
                    <h1 class="text-center mt-5">No products available</h1>
                {% endif %}
            {% endfor %}
        </div>
    </div>
{% endblock %}
